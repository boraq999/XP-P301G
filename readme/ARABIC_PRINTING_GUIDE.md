# ุฏููู ุญููู ุทุจุงุนุฉ ุงููุบุฉ ุงูุนุฑุจูุฉ ุนูู ุงูุทุงุจุนุงุช ุงูุญุฑุงุฑูุฉ (ESC/POS)
## Technical Guide for Arabic Thermal Printing

ูุฐุง ุงูุฏููู ููุฌู ูููุจุฑูุฌูู ุงูุฐูู ููุงุฌููู ูุดุงูู ูู ุทุจุงุนุฉ ุงููุบุฉ ุงูุนุฑุจูุฉ ุนูู ุทุงุจุนุงุช ุงูู Thermal (ูุซู Xprinter, Epson, ุฅูุฎ) ุจุงุณุชุฎุฏุงู ูุบุงุช ุจุฑูุฌูุฉ ูุฎุชููุฉ (JS, PHP, Python).

---

## 1. ุงููุดููุฉ (The Problem)
ุนูุฏ ุฅุฑุณุงู ูุต ุนุฑุจู ูุจุงุดุฑุฉ ููุทุงุจุนุฉุ ุชุธูุฑ ุงููุชุงุฆุฌ ูุงูุชุงูู:
*   **ุญุฑูู ุตูููุฉ ุฃู ุบุฑูุจุฉ:** ุจุณุจุจ ุนุฏู ุฏุนู ุงูุทุงุจุนุฉ ูุชุฑููุฒ UTF-8 ูุงุนุชูุงุฏูุง ุนูู Code Pages ูุฏููุฉ.
*   **ุนูุงูุงุช ุงุณุชููุงู (????):** ุจุณุจุจ ูุญุงููุฉ ุงูููุชุจุงุช ุชุญููู ุงูุญุฑูู ูุดูู ูุง ุชูููู ุงูุทุงุจุนุฉ.
*   **ุญุฑูู ููุทุนุฉ ููุนููุณุฉ:** ูุฃู ุงูุทุงุจุนุฉ ูุง ุชุฏุนู ุฎุงุตูุฉ ุงูุชุดููู (Reshaping) ูุงูุงุชุฌุงู ูู ุงููููู ูููุณุงุฑ (RTL).

---

## 2. ุงูุญููู ุงูุชูููุฉ ุงููุฌุฑุจุฉ (Attempted Solutions)

### ุฃ- ุงุณุชุฎุฏุงู ุตูุญุงุช ุงูุชุฑููุฒ (Code Pages)
ุชุนุชูุฏ ุงูุทุงุจุนุงุช ุนูู ุตูุญุงุช ูุซู `CP864` (ุนุฑุจู ุตูุจ) ุฃู `Windows-1256`. 
*   **ุงููุดููุฉ:** ุงูุชูุงูู ูุฎุชูู ูู ุทุงุจุนุฉ ูุฃุฎุฑู ุญุชู ูู ููุณ ุงููุงุฑูุฉ.
*   **ุงูุฃูุฑ ุงูุจุฑูุฌู:** `ESC t n` (ุญูุซ n ูู ุฑูู ุงูุตูุญุฉ). ูู Xprinter ุบุงูุจุงู ูุง ูููู 37 ูู PC864 ุฃู 50 ูู WPC1256.

### ุจ- ุงูุชุดููู ุงููุฏูู (Manual Reshaping)
ุจูุง ุฃู ุงูุทุงุจุนุฉ ูุง ุชููู ุฃู ุญุฑู "ุจ" ูู ุฃูู ุงููููุฉ ูุฎุชูู ุนู ุขุฎุฑูุงุ ูุฌุจ ุนูู ุงููุจุฑูุฌ ุชุบููุฑ ููุฏ ุงูุญุฑู ูุฏููุงู (Presentation Forms) ูุจู ุงุณุชุฎุฏุงูู.
*   **ุงูููุชุจุฉ ูู JS:** `arabic-reshaper`.
*   **ุงูููุชุจุฉ ูู Python:** `arabic-reshaper`.
*   **ุงูููุชุจุฉ ูู PHP:** `Ar-PHP`.

---

## 3. ุงูุญู ุงูุฐูุจู: ุงูุฑุณู ุนุจุฑ ุงูู Canvas (Server-side Rasterization)

ุจุนุฏ ุชุฌุงุฑุจ ุนุฏูุฏุฉุ ุชุจูู ุฃู ุฃูุถู ุญู "ุนุงุจุฑ ููููุตุงุช" ููุง ูุชุฃุซุฑ ุจููุน ุงูุทุงุจุนุฉ ูู **ุชุญููู ุงููุต ุฅูู ุตูุฑุฉ (Bitmap) ูู ุงูุณูุฑูุฑ** ูุจู ุฅุฑุณุงูู.

### ููุฑุฉ ุงูุญู (The Concept):
1.  ุจุฏูุงู ูู ุฅุฑุณุงู "ูุต"ุ ููุดุฆ ููุญุฉ ุฑุณู (Canvas) ุงูุชุฑุงุถูุฉ ูู ุงูุณูุฑูุฑ.
2.  ูุฑุณู ุงููุต ุจุงููุบุฉ ุงูุนุฑุจูุฉ ุจุงุณุชุฎุฏุงู ุฎุทูุท ุงููุธุงู (Segoe UI, Arial) ุงูุชู ุชุฏุนู ุงูุนุฑุจูุฉ ุจุดูู ูุซุงูู.
3.  ูุญูู ูุฐู ุงูููุญุฉ ุฅูู ุจุงูุชุงุช ุณูุฏุงุก ูุจูุถุงุก (Raster Data).
4.  ูุฑุณู ูุฐู ุงูุจุงูุชุงุช ููุทุงุจุนุฉ ูุฃูุฑ "ุตูุฑุฉ" (`GS v 0` ุฃู `ESC *`).

### ุฃูุซูุฉ ุจุฑูุฌูุฉ (Code Examples):

#### ๐ฉ JavaScript (Node.js) - ุจุงุณุชุฎุฏุงู ููุชุจุฉ `canvas`:
```javascript
const { createCanvas } = require('canvas');

function renderArabic(text) {
    const canvas = createCanvas(576, 100); // ุนุฑุถ 80mm
    const ctx = canvas.getContext('2d');
    ctx.fillStyle = 'white';
    ctx.fillRect(0, 0, 576, 100);
    
    ctx.fillStyle = 'black';
    ctx.font = '32px Arial';
    ctx.textAlign = 'right';
    ctx.direction = 'rtl';
    ctx.fillText(text, 560, 50);
    
    return canvas.toBuffer();
}
```

#### ๐ฆ PHP - ุจุงุณุชุฎุฏุงู ููุชุจุฉ `GD`:
```php
$im = imagecreatetruecolor(576, 100);
$white = imagecolorallocate($im, 255, 255, 255);
$black = imagecolorallocate($im, 0, 0, 0);
imagefilledrectangle($im, 0, 0, 576, 100, $white);

// ููุงุญุธุฉ: PHP ูุญุชุงุฌ ููุชุจุฉ ูุชุดููู ุงูุญุฑูู ูุซู Ar-PHP ูุจู ุงูุฑุณู
$text = "ูุฑุญุจุง ุจุงูุนุฑุจู"; 
imagettftext($im, 24, 0, 400, 50, $black, 'arial.ttf', $text);
// ุซู ุชุฑุณู ุงูุตูุฑุฉ ูู Bit Image ููุทุงุจุนุฉ
```

#### ๐จ Python - ุจุงุณุชุฎุฏุงู ููุชุจุฉ `Pillow`:
```python
from PIL import Image, ImageDraw, ImageFont
import arabic_reshaper
from bidi.algorithm import get_display

def create_image(text):
    reshaped_text = arabic_reshaper.reshape(text)
    bidi_text = get_display(reshaped_text)
    
    img = Image.new('RGB', (576, 100), color=(255, 255, 255))
    d = ImageDraw.Draw(img)
    font = ImageFont.truetype("arial.ttf", 32)
    d.text((10,10), bidi_text, fill=(0,0,0), font=font)
    img.save('print.png')
```

---

## 4. ุงููููุฒุงุช (Pros)
1.  **ุฏูุฉ ูุทููุฉ:** ูุธูุฑ ุงูุฎุท ุงูุนุฑุจู ุจุฌูุงูู ุงููุงูู (ูุชุตูุ ูุดููุ ูุจุฃู ุญุฌู).
2.  **ุงุณุชููุงููุฉ ุงููุงุฑุฏููุฑ:** ูุนูู ุนูู ุฃู ุทุงุจุนุฉ ุญุฑุงุฑูุฉ ุชุฏุนู ุทุจุงุนุฉ ุงูุตูุฑุ ุจุบุถ ุงููุธุฑ ุนู ูุบุชูุง ุงููุฏูุฌุฉ.
3.  **ุชูุณูู ูุชูุฏู:** ููููู ุฑุณู ุฌุฏุงููุ ุฎุทูุท ูููุทุฉุ ูุดุนุงุฑุงุช ุจุณูููุฉ ุชุงูุฉ.

## 5. ุงูุนููุจ (Cons)
1.  **ุญุฌู ุงูุจูุงูุงุช:** ุงูุจูุงูุงุช ุงููุฑุณููุฉ ููุทุงุจุนุฉ ุฃูุจุฑ ููููุงู ูู ุงููุต ุงููุฌุฑุฏุ ููู ูุน ุชูููุฉ `Raster` ุงูุณุฑูุนุฉ ูุง ูุดุนุฑ ุงููุณุชุฎุฏู ุจุงููุฑู.

---
*ุชู ุฅุนุฏุงุฏ ูุฐุง ุงูุฏููู ูุชูุซูู ุฑุญูุฉ ุญู ูุดููุฉ ุงูุทุจุงุนุฉ ุงูุนุฑุจูุฉ ูู ูุดุฑูุน XP-P301G.*
